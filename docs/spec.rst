
发光部分
*******

“发光部分”分别以荧光和磷光的计算为例，详细介绍了分子的量化计算、 EVC(Electron-Vibration Coupling)振动分析、吸收光谱、辐射光谱、辐射速率、内转换速率、系间窜越速率的计算过程。另外，本文还详细介绍了态求和方法和 Herzberg-Teller 效应的计算过程。
 

荧光
======
吸收光谱、荧光光谱以及辐射速率的计算流程以 azulene 为例，算例数据位于 momap/example/azulene/目录下。


1. 量化计算
-----------


a. 基态构型优化与频率计算
++++++++++++++++++++++


本算例部分计算文件在 azulene/gaussian/目录下。Gaussian 使用方法详见 Gaussian 手册。
以下为使用Gaussian进行基态构型优化与频率计算的输入文件的例子：

.. code-block:: bash

	%chk=azulene-s0.chk         #输出 chk 文件
	%mem=4GB                    #内存大小
	%nprocl=1                   #使用节点数
	%nprocs=16                  #每个节点上的并行的核数
	#p opt freq B3LYP/6-31G     #基于DFT方法/B3LYP 泛函/6-31G(d)基组对分子基态构型进行优化，然后计算优化后分子构型的频率

	azulene-s0 optimization	    #标题行

	0 1                         #净电荷数为 0，自选多重度为 1
	 C                  2.01378743   -1.48849852    0.00000000
	 C                  2.28995141   -0.11795315    0.00000000
	 C                  1.39185815    0.95357383    0.00000000
	 C                  0.78413689   -2.15418449    0.00000000
	 C                  0.00000000    0.93285810    0.00000000
	 C                 -0.50398383   -1.61065958    0.00000000
	 C                 -0.89316505   -0.27406276    0.00000000
	 H                  2.88919252   -2.13621797    0.00000000
	 H                  3.34387207    0.15083266    0.00000000
	 H                  1.84191311    1.94635990    0.00000000
	 H                  0.83658347   -3.24058384    0.00000000
	 H                 -1.32037398   -2.33298523    0.00000000
	 C                 -0.84567310    2.05536637    0.00000000
	 H                 -0.51364908    3.08694089    0.00000000
	 C                 -2.17758707    1.61062710    0.00000000
	 H                 -3.04994479    2.25593917    0.00000000
	 C                 -2.21339978    0.20656494    0.00000000
	 H                 -3.10314368   -0.41207657    0.00000000



计算结束后得到 azulene-s0.chk 和 azulene-s0.log 输出文件。
使用以下指令对二进制的 checkpoint 文件进行转换: 

	``formchk azulene-s0.chk``

运行结束后生成文件 azulene-s0.fchk，azulene-s0.flog 和 azulene-s0.fchk 这两个文件将用于后续的振动分析计算。




b. 激发态构型优化与频率计算
+++++++++++++++++++++++++

本部分计算文件在 azulene/gaussian/目录下。
基态 S0 构型优化完成后，使用 S0 优化后的构型作为激发态 S1 的初始构型， 用来优化激发态和计算激发态频率。


.. code-block:: bash

	%chk=azulene-s1.chk
	%mem=4GB
	%nprocl=1
	%nprocs=16
	#p opt freq td b3lyp/6-31g(d)	#基于TDDFT方法/B3LYP 泛函/6-31G(d)基组对分子激发态构型进行优化，然后计算优化后分子构型的频率

	azulene-s1 optimization	

	0 1
	 C                  2.01378700   -1.48849900    0.00000000
	 C                  2.28995100   -0.11795300    0.00000000
	 C                  1.39185800    0.95357400    0.00000000
	 C                  0.78413700   -2.15418400    0.00000000
	 C                  0.00000000    0.93285800    0.00000000
	 C                 -0.50398400   -1.61066000    0.00000000
	 C                 -0.89316500   -0.27406300    0.00000000
	 H                  2.88919300   -2.13621800    0.00000000
	 H                  3.34387200    0.15083300    0.00000000
	 H                  1.84191300    1.94636000    0.00000000
	 H                  0.83658300   -3.24058400    0.00000000
	 H                 -1.32037400   -2.33298500    0.00000000
	 C                 -0.84567300    2.05536600    0.00000000
	 H                 -0.51364900    3.08694100    0.00000000
	 C                 -2.17758700    1.61062700    0.00000000
	 H                 -3.04994500    2.25593900    0.00000000
	 C                 -2.21340000    0.20656500    0.00000000
	 H                 -3.10314400   -0.41207700    0.00000000



.. important ::

   	文件结尾注意空两行，表示高斯文件结束。



计算结束后得到 azulene-s1.chk 和 azulene-s1.log 输出文件。
使用以下指令对二进制的 checkpoint 文件进行转换: 

	``formchk azulene-s1.chk``

运行结束后生成文件 azulene-s1.fchk，azulene-s1.flog 和 azulene-s1.fchk 这两个文件将用于后续的振动分析计算。




2. 振动分析(EVC) 
---------------

本部分计算文件在 azulene/evc/目录下。


收集以上计算得到的基态和激发态的计算结果文件，包括日志文件 (azulene-s0.log、azulene-s1.log)和格式化的 Checkpoint 文件(azulene-s0.fchk、 azulene-s1.fchk)，注意需保证振动结果无虚频(在频率计算文件中搜索 Frequencies，注意 F 大写，可以找到频率信息)，将这些文件都放在一个文件夹 (evc)中，编写 EVC 振动分析的输入文件 momap.inp:

.. code-block:: bash

	do_evc          = 1                      # 1 表示开启dushin计算，0 表示关闭

	&evc
	  ffreq(1)      = "azulene-s0.log"       #基态结果的日志文件
	  ffreq(2)      = "azulene-s1.log"       #激发态结果的日志文件
	/


执行以下命令运行 EVC 振动分析程序:

	``momap –input momap.inp –nodefile nodefile``

程序正常结束后，得到下一步计算的输入文件 evc.cart.dat。



.. seealso ::

	 对以上MOMAP输入变量的解释，请参考API Reference部分.



.. important ::

   	MOMAP支持并行运算，如果使用队列脚本(如 PBS 脚本)提交任务，则只需在 PBS 脚本中修改提交队列名称、使用节点数量和核数量。

   	如果不使用队列脚本，可以在 nodefile 里 指定节点名称和核数。例如:需要使用节点名称为 node1 和 node2 的两个节点，每个节点上使用 2 个核。则 nodefile 写为 ::

	    node1 	
	    node1 	
	    node2 	
	    node2





3. 辐射速率
----------


a. 辐射速率输入文件 momap.inp:
++++++++++++++++++++++++++++

.. code-block:: bash

	do_spec_tvcf_ft   = 1                   #1 表示开启计算荧光关联函数
	do_spec_tvcf_spec = 1	                #1 表示开启计算荧光光谱

	&spec_tvcf                              #描述计算内容
	  DUSHIN        True                    #是否考虑 Duschinsky 转动(t 开启，f 关闭)
	  Temp          300                     #温度
	  tmax          1000                    #积分时间
	  dt            1                       #积分步长
	  Ead           0.07509                 #绝热激发能
	  EDMA          0.92694                 #吸收跃迁偶极矩
	  EDME          0.64751                 #发射跃迁偶极矩
	  FreqScale     1.0                     #频率缩放因子
	  DSFile        "evc.cart.dat"          #定义读取的 evc 文件名
	  Emax          0.3 au                  #定义光谱频率范围上限
	  dE            0.00001                 #定义输出能量间隔
	  logFile       "spec.tvcf.log"         #定义输出 log 文件名
	  FtFile        "spec.tvcf.ft.dat"      #定义输出的关联函数文件名
	  FoFile        "spec.tvcf.fo.dat"      #谱函数输出文件
	  FoSFile       "spec.tvcf.spec.dat"    #归一化的光谱输出文件
	/


.. seealso ::

	 对以上MOMAP输入变量的解释，请参考API Reference部分.


把 momap.inp 文件、nodefile 文件和 4.1.2 部分计算得到的 evc.cart.dat 文件 放置于同一目录，运行以下命令进行计算:

	``momap –input momap.inp –nodefile nodefile``



b. 计算结果解读:
+++++++++++++++++++

运行结束后会得到结果文件：

.. csv-table::
    :header: "输出文件名", "输出文件内容"

      spec.tvcf.fo.dat    ,             谱函数输出文件
      spec.tvcf.ft.dat    ,             关联函数输出文件
      spec.tvcf.log       ,             log 文件
      spec.tvcf.spec.dat  ,             光谱文件


1) 计算完成后先确认关联函数是否收敛，将 spec.tvcf.ft.dat 的前两列画图，若随着积分时间的增加，纵坐标的值基本为 0 且呈直线，则表示关联函数已经收敛。



2) 确认关联函数收敛后，根据光谱文件 spec.tvcf.spec.dat，选取所需数据画出 相关的吸收光谱和发射光谱:


3) 辐射速率 kr 可在 spec.tvcf.log 文件末端读取。如下图所示，第一个数值和第 二个数值都表示辐射速率，单位分别是 au 和 s-1，第三个数值表示寿命。计算得 到 azulene 分子的辐射速率 kr 为 2.72281554×105s-1。





4. 非辐射速率
------------

本部分计算文件在 azulene/kic/目录下。

计算内转换过程不仅需要分子基态 S0 与激发态 S1 的构型优化结果、频率计算结果，还需要包含与**非绝热耦合矩阵元相关的 azulene-nacme.log 文件**。非绝热 耦合计算时使用的计算方法、泛函等尽量与构型优化时保持一致。

a. 非绝热耦合矩阵元:
++++++++++++++++++

本部分计算文件在 azulene/kic/nacme/目录下。

在 S0 最稳定构型下设置关键词为:

.. code-block:: bash

	#p td B3lyp/6-31G(d) prop=(fitcharge,field) iop(6/22=-4, 6/29=1, 6/30=0, 6/17=2) nosymm


b. 振动分析(EVC):
++++++++++++++++++

本部分计算文件在相关算例 azulene/kic/evc/目录下。

收集基态、激发态计算结果文件，包括日志文件 (azulene-s0.log 和 azulene-s1.log)和格式化的 Checkpoint 文件(azulene-s0.fchk 和 azulene-s1.fchk)，注意需保证振动结果无虚频。此外，还有 非绝热耦合矩阵元相关的 azulene-nacme.log 文件。将这些文件都放在同一个目录中，编写 EVC 振动分析的输入文件 momap.inp

.. code-block:: bash

	do_evc          = 1                      #1 表示开启dushin计算，0 表示关闭

	&evc
	  ffreq(1)      = "azulene-s0.log"       #基态结果的日志文件
	  ffreq(2)      = "azulene-s1.log"       #激发态结果的日志文件
	  fnacme        = "azulene-nacme.log"    #非绝热耦合文件

	/


执行以下命令运行 EVC 振动分析程序:

	``momap –input momap.inp –nodefile nodefile``

程序正常结束后，得到下一步计算的输入文件 evc.cart.dat 和 evc.cart.nac。


c. 非辐射速率输入文件 momap.inp:
+++++++++++++++++++++++++++++


.. code-block:: bash

	do_ic_tvcf_ft   = 1                   #1 表示开启计算内转换关联函数
	do_ic_tvcf_spec = 1	                #1 表示开启计算内转换光谱

	&spec_tvcf                              #描述计算内容
	  DUSHIN        True                    #是否考虑 Duschinsky 转动(t 开启，f 关闭)
	  Temp          300                     #温度
	  tmax          1000                    #积分时间
	  dt            1                       #积分步长
	  Ead           0.07509                 #绝热激发能
	  DSFile        "evc.cart.dat"          #定义读取的 evc 文件名
	  CoulFile      "evc.cart.nac"          #定义读取的 nacme 文件名
	  Emax          0.3 au                  #定义光谱频率范围上限
	  dE            0.00001                 #定义输出能量间隔
	  logFile       "spec.tvcf.log"         #定义输出 log 文件名
	  FtFile        "spec.tvcf.ft.dat"      #定义输出的关联函数文件名
	  FoFile        "spec.tvcf.fo.dat"      #谱函数输出文件
	/

d. 计算结果解读:
+++++++++++++++++++

运行结束后会得到结果文件与相应解读与辐射速率结果类似。




磷光
======
本部分以 Ir(ppy)3 为例，计算文件在 Irppy3/目录下。


1. 量化计算
-----------

a. 基态构型优化与频率计算
++++++++++++++++++++++


本算例部分计算文件在 Irppy3/gaussian/目录下。Gaussian 使用方法详见 Gaussian 手册。
以下为使用Gaussian进行基态构型优化与频率计算的输入文件的例子：

.. code-block:: bash

	%chk=Irppy3-s0-freq.chk
	%mem=32GB
	%nprocl=1
	%nprocs=16
	#p opt freq b3lyp/gen pseudo=read	

	Ir Complex No.1 - S0 Opt	

	0 1
	 Ir                -0.00026100    0.00081800   -0.02546400
	 C                  1.23475200    1.22563100   -1.06555400
	 C                  3.17477000    2.89735700   -2.32701500
	 C                  0.92442700    1.99391300   -2.20485100
	 C                  2.57228300    1.32514600   -0.57850700
	 C                  3.52102800    2.15413000   -1.20673700
	 C                  1.86871700    2.81106300   -2.82461100
	 H                 -0.07806200    1.94413900   -2.61745300
	 H                  4.53611800    2.22106900   -0.82434500
	 H                  1.58801500    3.38649600   -3.70399300
	 H                  3.90950000    3.53555700   -2.80932100
	 C                 -1.68090200    0.45115400   -1.06441800
	 C                 -4.10462500    1.28419800   -2.32155800
	 C                 -2.19366100   -0.20890200   -2.19864300
	 C                 -2.43666500    1.56010300   -0.57980000
	 C                 -3.63180700    1.96181000   -1.20602100
	 C                 -3.37645500    0.19503800   -2.81613100
	 H                 -1.64954600   -1.05410200   -2.60798800
	 H                 -4.19743200    2.80807400   -0.82543100
	 H                 -3.73660800   -0.34100200   -3.69145400
	 H                 -5.02681900    1.59733000   -2.80241700
	 C                  0.44814900   -1.68217800   -1.06264200
	 C                  0.93597200   -4.20000800   -2.31586900
	 C                 -0.13342900   -2.89014400   -0.57453500
	 C                  1.27344300   -1.79837800   -2.19826500
	 C                  1.51368500   -3.02576800   -2.81412000
	 C                  0.11498600   -4.12730600   -1.19874400
	 H                  1.73187800   -0.90533900   -2.61031500
	 H                  2.15615300   -3.07132700   -3.69070700
	 H                 -0.33389100   -5.03985700   -0.81551700
	 H                  1.12519700   -5.15619800   -2.79506200
	 C                 -1.84954400    3.97562700    2.29857000
	 C                 -0.66117200    3.42699800    2.78968100
	 C                 -0.14420200    2.30972600    2.14783000
	 N                 -0.73864000    1.73597200    1.08811300
	 C                 -1.89508200    2.25982300    0.58820300
	 C                 -2.46253000    3.39278500    1.19875100
	 H                 -2.28864400    4.85171900    2.76697600
	 H                 -0.14391600    3.85372400    3.64187900
	 H                  0.77874100    1.84449000    2.47700800
	 H                 -3.37901400    3.81370900    0.80286200
	 C                 -2.51383600   -3.58201200    2.30997200
	 C                 -2.63109400   -2.27735000    2.79844200
	 C                 -1.92302300   -1.27278700    2.15278800
	 N                 -1.13102600   -1.50374000    1.09212900
	 C                 -1.00809700   -2.76827000    0.59477000
	 C                 -1.70499700   -3.82446000    1.20898200
	 H                 -3.05245100   -4.39896200    2.78140100
	 H                 -3.25737200   -2.04053600    3.65143900
	 H                 -1.98095800   -0.24001800    2.47975100
	 H                 -1.61237900   -4.82930800    0.81482900
	 C                  4.35781900   -0.37940500    2.31491700
	 C                  3.28567000   -1.13065100    2.80535400
	 C                  2.06245800   -1.02194200    2.15784700
	 N                  1.86828500   -0.22560100    1.09293800
	 C                  2.90273000    0.51092000    0.59411300
	 C                  4.16509200    0.43765200    1.21020600
	 H                  5.33396800   -0.43571700    2.78791400
	 H                  3.39236400   -1.78733400    3.66167400
	 H                  1.19605700   -1.58570100    2.48734100
	 H                  4.98966700    1.01859900    0.81497000	

	C H N 0
	6-31G**
	****
	Ir 0
	LANL2DZ
	****	

	Ir 0
	LANL2DZ



b. 激发态构型优化与频率计算
+++++++++++++++++++++++++

本部分计算文件在 azulene/gaussian/目录下。
优化 Ir(ppy)3 分子基态 S0 构型并计算其频率。在基态 S0 最稳定构型下优化分子三重激发态 T1 的构型并计算其频率。


.. code-block:: bash

	%chk=Irppy3-t1.chk
	%mem=32GB
	%nprocl=1
	%nprocs=28
	#p opt freq b3lyp/gen pseudo=read	

	Ir Complex No.1 - T1 Opt	

	0 3
	 Ir                 0.00008200    0.00019800    0.02644100
	 C                  1.73535200   -0.12611700    1.06565900
	 C                  4.29802700   -0.13569000    2.32321100
	 C                  2.00103900   -0.91349800    2.20328400
	 C                  2.81507600    0.66915000    0.57816800
	 C                  4.07583300    0.65577500    1.20452400
	 C                  3.25072900   -0.92073000    2.82105800
	 H                  1.20790500   -1.52899000    2.61532000
	 H                  4.88968300    1.26588000    0.82177000
	 H                  3.41338800   -1.54205300    3.69897100
	 H                  5.27194800   -0.14320400    2.80397800
	 C                 -0.97738100   -1.43942700    1.06523100
	 C                 -2.26673600   -3.65411200    2.32277100
	 C                 -1.79225900   -1.27589100    2.20274400
	 C                 -0.82823000   -2.77212300    0.57779600
	 C                 -1.47010600   -3.85734300    1.20413200
	 C                 -2.42320900   -2.35461700    2.82055300
	 H                 -1.92884600   -0.28125200    2.61469900
	 H                 -1.34845100   -4.86721300    0.82145400
	 H                 -3.04268100   -2.18488600    3.69843500
	 H                 -2.76005600   -4.49386100    2.80357500
	 C                 -0.75865300    1.56638200    1.06492300
	 C                 -2.03294500    3.78991000    2.32216300
	 C                 -1.98758300    2.10297300    0.57734500
	 C                 -0.20988000    2.19068100    2.20237900
	 C                 -0.82907700    3.27628600    2.82002300
	 C                 -2.60698700    3.20123000    1.20358900
	 H                  0.71990600    1.81201700    2.61446000
	 H                 -0.37254700    3.72823200    3.69783700
	 H                 -3.54253900    3.60037500    0.82082200
	 H                 -2.51389300    4.63688600    2.80282600
	 C                  1.18347800   -4.21358500   -2.31027400
	 C                  1.72536400   -3.02147300   -2.79986300
	 C                  1.39110400   -1.83900800   -2.15374300
	 N                  0.56965200   -1.79453700   -1.09124600
	 C                  0.03546400   -2.94691000   -0.59299600
	 C                  0.34194900   -4.17433200   -1.20778000
	 H                  1.42018100   -5.16286700   -2.78205800
	 H                  2.39302700   -3.00556100   -3.65418400
	 H                  1.78639500   -0.88359900   -2.48208900
	 H                 -0.07776600   -5.09178100   -0.81306900
	 C                 -4.24058000    1.08069400   -2.31139700
	 C                 -3.47808900    0.01626500   -2.80137400
	 C                 -2.28682000   -0.28480400   -2.15511200
	 N                 -1.83848700    0.40412100   -1.09208100
	 C                 -2.57024700    1.44221200   -0.59362200
	 C                 -3.78662300    1.78976200   -1.20851200
	 H                 -5.18118200    1.34974900   -2.78322600
	 H                 -3.79743900   -0.56974700   -3.65606500
	 H                 -1.65615900   -1.10403100   -2.48372100
	 H                 -4.37204800    2.61133900   -0.81359600
	 C                  3.05805000    3.13098300   -2.31082000
	 C                  1.75471500    3.00417800   -2.80042500
	 C                  0.89768700    2.12382400   -2.15397800
	 N                  1.26975400    1.39058000   -1.09116500
	 C                  2.53479900    1.50421700   -0.59286500
	 C                  3.44467300    2.38298700   -1.20798600
	 H                  3.76192200    3.81029400   -2.78288500
	 H                  1.40718600    3.57413800   -3.65497900
	 H                 -0.12737800    1.98840000   -2.48227400
	 H                  4.44908200    2.47822400   -0.81331900	

	C H N 0
	6-31G**
	****
	Ir 0
	LANL2DZ
	****	

	Ir 0
	LANL2DZ



算例中采用构型和频率分开计算的方式进行。 计算后得到基态 S0 和激发态 T1 计算的日志文件 Irppy3-s0-opt.log、Irppy3-s0-freq.log、Irppy3-t1-opt.log、Irppy3-t1-freq.log、Irppy3-s0-freq.chk 和 Irppy3-t1-freq.chk。使用 formchk 命令将 chk 文件转换为 Checkpoint 文件 Irppy3-s0-freq.fchk 和 Irppy3-t1-freq.fchk。这些文件将用于后续的振动分析计算。



2. 振动分析(EVC) 
---------------

本部分计算文件在 Irppy3/evc/目录下。


收集计算得到的基态 S0、三重激发态 T1 的计算结果文件，包括日志文件 (Irppy3-s0-freq.log 和 Irppy3-t1-freq.log)和格式化的 Checkpoint 文件 (Irppy3-s0-freq.fchk 和 Irppy3-t1-freq.fchk)，注意需保证振动结果无虚频。将这些文件都放在一个文件夹 (evc)中，编写 EVC 振动分析的输入文件 momap.inp:

.. code-block:: bash

	do_evc          = 1                      # 1 表示开启dushin计算，0 表示关闭

	&evc
	  ffreq(1)      = "azulene-s0.log"       #基态结果的日志文件
	  ffreq(2)      = "azulene-s1.log"       #激发态结果的日志文件
	/



3. 辐射速率
----------


a. 辐射速率输入文件 momap.inp:
++++++++++++++++++++++++++++

.. code-block:: bash

	do_spec_tvcf_ft   = 1                   #1 表示开启计算磷光关联函数
	do_spec_tvcf_spec = 1	                #1 表示开启计算磷光光谱

	&spec_tvcf                              #描述计算内容
	  DUSHIN        .t.                     #是否考虑 Duschinsky 转动(t 开启，f 关闭)
	  Temp          300                     #温度
	  tmax          1500 fs                 #积分时间
	  dt            0.01 fs                 #积分步长
	  Ead           0.09418289 au           #绝热激发能
	  EDMA          1 debye                 #吸收跃迁偶极矩
	  EDME          0.306909 debye          #发射跃迁偶极矩
	  FreqScale     1.0                     #频率缩放因子
	  DSFile        "evc.cart.dat"          #定义读取的 evc 文件名
	  Emax          0.3 au                  #定义光谱频率范围上限
	  dE            0.00001 au              #定义输出能量间隔
	  logFile       "spec.tvcf.log"         #定义输出 log 文件名
	  FtFile        "spec.tvcf.ft.dat"      #定义输出的关联函数文件名
	  FoFile        "spec.tvcf.fo.dat"      #谱函数输出文件
	  FoSFile       "spec.tvcf.spec.dat"    #归一化的光谱输出文件
	/


.. seealso ::

	 对以上MOMAP输入变量的解释，请参考API Reference部分.


把 momap.inp 文件、nodefile 文件和 EVC 部分计算得到的 evc.cart.dat 文件放置于同一目录，运行以下命令进行计算:

	``momap –input momap.inp –nodefile nodefile``



b. 计算结果解读:
+++++++++++++++++++

运行结束后会得到结果文件：

.. csv-table::
    :header: "输出文件名", "输出文件内容"

	    spec.tvcf.fo.dat    ,             谱函数输出文件
	    spec.tvcf.ft.dat    ,             关联函数输出文件
	    spec.tvcf.log       ,             log 文件
	    spec.tvcf.spec.dat  ,             光谱文件


1) 计算完成后先确认关联函数是否收敛，将 spec.tvcf.ft.dat 的前两列画图，若随着积分时间的增加，纵坐标的值基本为 0 且呈直线，则表示关联函数已经收敛。



2) 确认关联函数收敛后，根据光谱文件 spec.tvcf.spec.dat，选取所需数据画出 相关的吸收光谱和发射光谱:


3) 辐射速率 kr 可在 spec.tvcf.log 文件末端读取。如下图所示，第一个数值和第 二个数值都表示辐射速率，单位分别是 au 和 s-1，第三个数值表示寿命。计算得 到 azulene 分子的辐射速率 kr 为 2.72281554×105s-1。





4. 非辐射速率
------------

本部分计算文件在 Irppy3/kisc/目录下。

计算系间窜越需要读取分子的自旋轨道耦合常数 Hso。本算例采用 Dalton 软件计算得到自旋轨道耦合常数 Hso 为 116.877376 cm-1。




非辐射速率输入文件 momap.inp:
+++++++++++++++++++++++++++++


.. code-block:: bash

	do_isc_tvcf_ft   = 1                   #1 表示开启计算系间窜越关联函数
	do_isc_tvcf_spec = 1	                #1 表示开启计算系间窜越光谱

	&isc_tvcf                              #描述计算内容
	  DUSHIN        .t.                     #是否考虑 Duschinsky 转动(t 开启，f 关闭)
	  Temp          298 K                   #温度
	  tmax          1500 fs                 #积分时间
	  dt            0.01 fs                 #积分步长
	  Ead           0.09418289 au           #绝热激发能
	  Hso           116.877376 cm-1         #旋轨耦合常数
	  DSFile        "evc.cart.dat"          #定义读取的 evc 文件名
	  CoulFile      "evc.cart.nac"          #定义读取的 nacme 文件名
	  Emax          0.3 au                  #定义光谱频率范围上限
	  dE            0.00001                 #定义输出能量间隔
	  logFile       "isc.tvcf.log"          #定义输出 log 文件名
	  FtFile        "isc.tvcf.ft.dat"       #定义输出的关联函数文件名
	  FoFile        "isc.tvcf.fo.dat"       #谱函数输出文件
	/


态求和方法
=========
本部分以 azulene 为例，计算文件在 azulene/sum/目录下。
态求和方法量化计算和 EVC 计算部分与关联函数方法相同。

.. code-block:: bash

	do_spec_sums    = 1                    #使用态求和方法

	&spec_sums                             #描述计算内容
	  DSFile        = "evc.cart.dat"       #定义读取的 evc 文件名
	  Ead           = 0.094313868 au       #绝热激发能
	  dipole_abs    = 0.092465 debye       #吸收跃迁偶极矩
	  dipole_emi    = 0.440702 debye       #发射跃迁偶极矩
	  maxvib        = 10                   #最大振动量子数
	  if_cal_ic     = .t.                  #是否做内转换通道分析
	  promode       = 24                   #提升模式(内转换通道分析)
	  FC_eps_abs    = 0.1                  #Franck-Condon 因子阈值(吸收)
	  FC_eps_emi    = 0.1                  #Franck-Condon 因子阈值(辐射)
	  FC_eps_ic     = 0.1                  #Franck-Condon 因子阈值(内转换)
	  FreqScale     = 1.0                  #频率缩放因子
	  Seps          = 0.00001              #黄昆因子阈值
	  FWHM          = 500   cm-1           #展宽因子(半高全宽)
	  flog          = "spec.sums.log"      #输出 log 文件
	/





Herzberg-Teller 效应
========================

本部分以 porphine 为例，计算文件在 porphine/目录下。
一般当计算体系为弱发光体系或者柔性分子时，在计算过程中加入 HT 效应 会比较显著，是否考虑 Herzberg-Teller 效应需要根据用户理论知识和计算过程自 行决定，具体方法如下文所述。


1. 量化计算
-----------

a. 基态构型优化与频率计算
++++++++++++++++++++++


本部分计算文件在 porphine/gaussian/目录下。
以下为使用Gaussian进行基态构型优化与频率计算的输入文件的例子：

.. code-block:: bash	

	%chk=porphine-s0.chk
	%mem=32GB
	%nprocl=4
	%nprocs=16
	#p opt freq b3lyp/6-31g(d)	

	opt-porphine-s0	

	0 1
	 N                  2.01760000   -2.03040000    0.00000000
	 N                  2.01120000   -4.36830000    0.00000000
	 N                  4.36180000   -2.03680000    0.00000000
	 N                  4.33573828   -4.45908404   -0.00000000
	 C                  0.65970000   -2.03040000    0.00000000
	 C                  2.01760000   -0.68530000    0.00000000
	 C                  0.65970000   -4.36830000    0.00000000
	 C                  4.36180000   -0.68530000    0.00000000
	 C                  2.01120000   -5.72610000    0.00000000
	 C                  5.71970000   -2.03680000    0.00000000
	 C                  4.34263459   -5.72608147    0.00000000
	 C                  5.70087915   -4.18727747    0.00000000
	 C                  0.00000000   -3.19610000    0.00000000
	 C                  3.18330000   -0.00640000    0.00000000
	 C                  3.17050000   -6.40510000    0.00000000
	 C                  6.37940000   -3.19610000    0.00000000
	 C                  0.00000000   -0.85190000    0.00000000
	 C                  0.85190000   -0.00640000    0.00000000
	 C                  0.00000000   -5.52760000    0.00000000
	 C                  5.52760000    0.00000000    0.00000000
	 C                  0.85190000   -6.39230000    0.00000000
	 C                  6.39230000   -0.87110000    0.00000000
	 C                  5.52120000   -6.39230000    0.00000000
	 C                  6.37940000   -5.54680000    0.00000000
	 H                  2.72470678   -2.73750678    0.00000000
	 H                  3.60232364   -3.73361018    0.00000000
	 H                 -1.06999924   -3.19482666    0.00000000
	 H                  3.18076601    1.06359700    0.00000000
	 H                  3.16668309   -7.47509319    0.00000000
	 H                  7.44939236   -3.19205755    0.00000000
	 H                 -1.05961692   -0.70319904    0.00000000
	 H                  0.71624112    1.05496547    0.00000000
	 H                 -1.06093024   -5.66662166    0.00000000
	 H                  5.66506569    1.06113297    0.00000000
	 H                  0.70721085   -7.45247218    0.00000000
	 H                  7.45338318   -0.73325047    0.00000000
	 H                  5.66051034   -7.45319237    0.00000000
	 H                  7.43956765   -5.69152234    0.00000000





b. 激发态构型优化与频率计算
+++++++++++++++++++++++++

本部分计算文件在 porphine/gaussian/目录下。
激发态 s1 的输入文件如下：

.. code-block:: bash

	%chk=porphine-s1.chk
	%mem=32GB
	%nprocl=4
	%nprocs=16
	#p td opt freq b3lyp/6-31g(d)	

	opt-porphine-s1	

	0 1
	 N                  0.00016100   -2.11714500    0.00000000
	 N                  2.02941000   -0.00021700    0.00000000
	 N                 -2.02930500    0.00013800    0.00000000
	 N                 -0.00017500    2.11713800    0.00000000
	 C                  1.13015400   -2.89626300    0.00000000
	 C                 -1.13004200   -2.89587500    0.00000000
	 C                  2.85552900   -1.08516900    0.00000000
	 C                 -2.85547700   -1.08473700    0.00000000
	 C                  2.85509100    1.08441700    0.00000000
	 C                 -2.85507800    1.08479400    0.00000000
	 C                  1.13015400    2.89593200    0.00000000
	 C                 -1.13027800    2.89613600    0.00000000
	 C                  2.44125900   -2.42217000    0.00000000
	 C                 -2.44111000   -2.42173100    0.00000000
	 C                  2.44086700    2.42186600    0.00000000
	 C                 -2.44102300    2.42217400    0.00000000
	 C                  0.68600000   -4.26037000    0.00000000
	 C                 -0.68632300   -4.26013600    0.00000000
	 C                  4.25808500   -0.67810100    0.00000000
	 C                 -4.25798700   -0.67784300    0.00000000
	 C                  4.25789200    0.67789400    0.00000000
	 C                 -4.25790500    0.67815100    0.00000000
	 C                  0.68599900    4.26043200    0.00000000
	 C                 -0.68586900    4.26061300    0.00000000
	 H                  0.00057000   -1.10169100    0.00000000
	 H                 -0.00064500    1.10167800    0.00000000
	 H                  3.21982300   -3.17967100    0.00000000
	 H                 -3.21964400   -3.17926500    0.00000000
	 H                  3.21969900    3.17907900    0.00000000
	 H                 -3.21984800    3.17936700    0.00000000
	 H                  1.34702200   -5.11705700    0.00000000
	 H                 -1.34768400   -5.11656600    0.00000000
	 H                  5.10635600   -1.35193800    0.00000000
	 H                 -5.10625200   -1.35169400    0.00000000
	 H                  5.10596000    1.35197600    0.00000000
	 H                 -5.10606600    1.35212700    0.00000000
	 H                  1.34737700    5.11686400    0.00000000
	 H                 -1.34692600    5.11729600    0.00000000



计算后得到基态 S0 和激发态 S1 计算的日志文件 porphine-s0.log、 porphine-s1.log、porphine-s0.chk 和 porphine-s1.chk。使用 formchk 命令将 porphine-s0.chk 和 porphine-s1.chk 转换为 Checkpoint 文件 porphine-s0.fchk 和 porphine-s1.fchk。这些文件将用于后续的振动分析计算。


2. 计算 numfreq 
---------------

考虑 Herzberg-Teller 效应需要进行 numfreq 计算，本部分计算在 porphine/numfreq/目录下。

输入文件包含:porphine-s1.com、input、nodefile。 构建 porphine-s1.com 文件，包含 s1 态优化后的平衡构型:

.. code-block:: bash

	%chk=porphine-s1.chk
	%mem=32GB
	%nprocl=1
	%nprocs=16
	#p td(root=1) b3lyp/6-31g(d)	

	numfreq-porphine-s1	

	0 1
	 N                 -2.11384400   -0.00001800    0.00000000
	 N                 -0.00006900   -2.05188400    0.00000000
	 N                  0.00006800    2.05188500    0.00000000
	 N                  2.11384300    0.00001700    0.00000000
	 C                 -2.89604400   -1.13283300    0.00000000
	 C                 -2.89618900    1.13269100    0.00000000
	 C                 -1.08901100   -2.88277400    0.00000000
	 C                 -1.08901100    2.88263300    0.00000000
	 C                  1.08901100   -2.88262900    0.00000000
	 C                  1.08901100    2.88277000    0.00000000
	 C                  2.89619400   -1.13268800    0.00000000
	 C                  2.89604800    1.13283000    0.00000000
	 C                 -2.42772400   -2.44844700    0.00000000
	 C                 -2.42776700    2.44830900    0.00000000
	 C                  2.42776600   -2.44831100    0.00000000
	 C                  2.42772200    2.44844800    0.00000000
	 C                 -4.26026800   -0.68753300    0.00000000
	 C                 -4.26036800    0.68731000    0.00000000
	 C                 -0.68129900   -4.27776900    0.00000000
	 C                 -0.68142300    4.27767200    0.00000000
	 C                  0.68142500   -4.27767100    0.00000000
	 C                  0.68130100    4.27776900    0.00000000
	 C                  4.26036500   -0.68731500    0.00000000
	 C                  4.26026400    0.68753800    0.00000000
	 H                 -1.09988600    0.00015100    0.00000000
	 H                  1.09988500   -0.00015800    0.00000000
	 H                 -3.19164600   -3.22081100    0.00000000
	 H                 -3.19172100    3.22066300    0.00000000
	 H                  3.19172100   -3.22066400    0.00000000
	 H                  3.19164600    3.22081000    0.00000000
	 H                 -5.11723000   -1.34805000    0.00000000
	 H                 -5.11733600    1.34780700    0.00000000
	 H                 -1.35301100   -5.12739200    0.00000000
	 H                 -1.35313400    5.12728400    0.00000000
	 H                  1.35313600   -5.12728300    0.00000000
	 H                  1.35301400    5.12739100    0.00000000
	 H                  5.11733400   -1.34781000    0.00000000
	 H                  5.11722500    1.34805600    0.00000000

构建 input 文件:

.. code-block:: bash

	&control
	qctype = "gaussian"
	task = "numfreq"
	fxyz = "porphine-s1.com" symm = .false.
	dx = 0.01
	/



任务计算完成后会生成 PES-0 文件夹，文件夹内有 numfreq-es.out 文件




3. 振动分析(EVC) 
---------------

将 4.4.1 和 4.4.2 部分计算得到的 porphine-s0.log、porphine-s1.log、porphine-s0.fchk、porphine-s1.fchk 和 numfreq-es.out 文件放入 porphine/evc/目录下。构建 momap.inp 文件，evc 部分添加关键词:ftdipd = "numfreq-es.out"。如下 图所示:

.. code-block:: bash

	do_evc          = 1                      # 1 表示开启dushin计算，0 表示关闭

	&evc
	  ffreq(1)      = "porphine-s0.log"       #基态结果的日志文件
	  ffreq(2)      = "porphine-s1.log"       #激发态结果的日志文件
	  ftdipd        = "numfreq-es.out"        #DIP计算输出文件
	  sort_mode     = 1                       #模式
	/



计算完成后得到 evc.cart.dat 和 evc.cart.dip，这两个文件将于用后续计算。



4. 辐射速率
----------

本部分计算在 porphine/kr/目录下

辐射速率输入文件 momap.inp:
++++++++++++++++++++++++++++

.. code-block:: bash

	do_spec_tvcf_ft   = 1                   #1 表示开启计算磷光关联函数
	do_spec_tvcf_spec = 1	                #1 表示开启计算磷光光谱

	&spec_tvcf                              #描述计算内容
	  DUSHIN        .t.                     #是否考虑 Duschinsky 转动(t 开启，f 关闭)
	  Temp          300                     #温度
	  tmax          3000 fs                 #积分时间
	  dt            0.01 fs                 #积分步长
	  Ead           0.083121346 au          #绝热激发能
	  EDMA          0.025417 debye          #吸收跃迁偶极矩
	  EDME          0.378704 debye          #发射跃迁偶极矩
	  DSFile        "evc.cart.dat"          #定义读取的 evc 文件名
	  DDplFile      "evc.cart.dip"          #定义读取的 dip 文件名
	  Emax          0.3 au                  #定义光谱频率范围上限
	  dE            0.00001 au              #定义输出能量间隔
	  logFile       "spec.tvcf.log"         #定义输出 log 文件名
	  FtFile        "spec.tvcf.ft.dat"      #定义输出的关联函数文件名
	  FoFile        "spec.tvcf.fo.dat"      #谱函数输出文件
	  FoSFile       "spec.tvcf.spec.dat"    #归一化的光谱输出文件
	/



把 momap.inp 文件、nodefile 文件和 EVC 部分计算得到的 evc.cart.dat 和 evc.cart.dip 文件 放置于同一目录，运行以下命令进行计算:

	``momap –input momap.inp –nodefile nodefile``





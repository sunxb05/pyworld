\documentclass{article}

\usepackage[latin1]{inputenc}
\usepackage{tikz}

\setlength{\pdfpagewidth}{20.2cm}
\setlength{\pdfpageheight}{18cm}
%\setlength{\pdfvorigin}{25.4mm}

\setlength{\textwidth}{20.2cm}
\setlength{\textheight}{18cm}
%\setlength{\evensidemargin}{-2.7cm}
\setlength{\oddsidemargin}{-3.1cm}
\setlength{\topmargin}{-4.45cm}
\setlength{\headheight}{2cm}
\setlength{\headsep}{0cm}

\usetikzlibrary{shapes,arrows,shapes.geometric,calc,patterns}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{color}

\begin{document}

\pagestyle{empty}

\tikzstyle{block}=[color=black, rectangle, draw, sharp corners, very thin, node distance=0mm]
\tikzstyle{arrow}=[draw, very thick, -latex']

\begin{tikzpicture}[scale=1, auto]

% macro recurrence relations (1)
\node at (0mm,88.5mm) {\large\textbf{(\textit{a})}};
%
\node at (-4mm,98mm) {$s$};
\node at (0mm,98mm) {$p$};
\node at (9mm,98mm) {$d$};
\node at (25mm,98mm) {$f$};
\node at (50mm,98mm) {$g$};
%
\node at (-7mm,101mm) {$s$};
\node[block, fill=black!15, minimum width=2mm, minimum height=2mm] at (-4mm,101mm){};
\node[block, fill=black!15, minimum width=12mm, minimum height=2mm] at (9mm,101mm){};
\node[block, fill=black!15, minimum width=30mm, minimum height=2mm] at (50mm,101mm){};
%
\node at (-7mm,105mm) {$p$};
\node[block, fill=black!15, minimum width=6mm, minimum height=6mm] at (0mm,105mm){};
\node[block, fill=black!15, minimum width=20mm, minimum height=6mm] at (25mm,105mm){};
%
\node at (-7mm,114mm) {$d$};
\node[block, fill=black!30, minimum width=2mm, minimum height=12mm] at (-4mm,114mm){};
\node[block, fill=black!15, minimum width=12mm, minimum height=12mm] at (9mm,114mm){};
%
\node at (-7mm,130mm) {$f$};
\node[block, fill=black!30, minimum width=6mm, minimum height=20mm] at (0mm,130mm){};
%
\node at (-7mm,155mm) {$g$};
\node[block, fill=black!50, minimum width=2mm, minimum height=30mm] at (-4mm,155mm){};

% points to sub-recurrence relations
\path[arrow, color=black, dashed](0mm,140mm)--node{}(-3mm,155mm);
\path[arrow, color=black, dashed](-4mm,120mm)--node{}(-4mm,140mm);
\node [single arrow, rotate=-25, fill=black!30, minimum height=85mm, minimum width=15mm, %
  single arrow head extend=3mm, single arrow head indent=2mm] %
  at (50mm,125mm) {sub-recurrence relations};

% axis of Hermite
\path[arrow](-12mm,92mm)--node[yshift=-7mm]{Hermite ($\min_{\text{Herm}}=\max_{\text{Herm}}=0$)}(80mm,92mm);
% axis of Cartesian
\path[arrow](-12mm,92mm)--node[rotate=90, xshift=30mm, yshift=3mm] %
  {Cartesian ($\min_{\text{Cart}}=\max_{\text{Cart}}=4$)}(-12mm,175mm);

% macro recurrence relations (2)
\node at (0mm,3.5mm) {\large\textbf{(\textit{b})}};
%
\node at (-4mm,13mm) {$s$};
\node at (0mm,13mm) {$p$};
\node at (9mm,13mm) {$d$};
\node at (25mm,13mm) {$f$};
\node at (50mm,13mm) {$g$};
%
\node at (-7mm,16mm) {$s$};
\node[block, fill=black!15, minimum width=2mm, minimum height=2mm] at (-4mm,16mm){};
\node[block, fill=black!30, minimum width=6mm, minimum height=2mm] at (0mm,16mm){};
\node[block, fill=black!15, minimum width=12mm, minimum height=2mm] at (9mm,16mm){};
\node[block, fill=black!15, minimum width=20mm, minimum height=2mm] at (25mm,16mm){};
\node[block, fill=black!15, minimum width=30mm, minimum height=2mm] at (50mm,16mm){};
%
\node at (-7mm,20mm) {$p$};
\node[block, fill=black!15, minimum width=2mm, minimum height=6mm] at (-4mm,20mm){};
\node[block, fill=black!15, minimum width=6mm, minimum height=6mm] at (0mm,20mm){};
\node[block, fill=black!30, minimum width=12mm, minimum height=6mm] at (9mm,20mm){};
\node[block, fill=black!15, minimum width=20mm, minimum height=6mm] at (25mm,20mm){};
%
\node at (-7mm,29mm) {$d$};
\node[block, fill=black!50, minimum width=2mm, minimum height=12mm] at (-4mm,29mm){};
\node[block, fill=black!50, minimum width=6mm, minimum height=12mm] at (0mm,29mm){};
\node[block, fill=black!15, minimum width=12mm, minimum height=12mm] at (9mm,29mm){};
%
\node at (-7mm,45mm) {$f$};
\node[block, fill=black!50, minimum width=2mm, minimum height=20mm] at (-4mm,45mm){};
\node[block, fill=black!50, minimum width=6mm, minimum height=20mm] at (0mm,45mm){};

% points to sub-recurrence relations
\path[arrow, color=black, dashed](9mm,23mm)--node{}(3mm,29mm);
\path[arrow, color=black, dashed](0mm,17mm)--node{}(0mm,23mm);
\node [single arrow, rotate=30, fill=black!30, minimum height=85mm, minimum width=15mm, %
  single arrow head extend=3mm, single arrow head indent=2mm] %
  at (50mm,60mm) {sub-recurrence relations};

% axis of Hermite
\path[arrow](-12mm,7mm)--node[yshift=-7mm]{Hermite ($\min_{\text{Herm}}=0$, $\max_{\text{Herm}}=1$)}(80mm,7mm);
% axis of Cartesian
\path[arrow](-12mm,7mm)--node[rotate=90, xshift=30mm, yshift=3mm] %
  {Cartesian ($\min_{\text{Cart}}=2$, $\max_{\text{Cart}}=3$)}(-12mm,80mm);

% procedure of sub-recurrence relations
\node[block, dashed, fill=black!5, minimum width=90mm, minimum height=110mm] at (138.5mm,121mm){};
%
\node at (136mm,172mm) %
  {$\{\boldsymbol{i}\mathrm{+}\boldsymbol{e}_{\xi},\boldsymbol{j}\}=a\left(\{\boldsymbol{i},\boldsymbol{j}\mathrm{+}\boldsymbol{e}_{\xi}\}%
    +\boldsymbol{i}_{\xi}\{\boldsymbol{i}\mathrm{-}\boldsymbol{e}_{\xi},\boldsymbol{j}\}\right)$};
%
\node[block, minimum width=27mm, minimum height=13.5mm](sub-pd) at (116.5mm,76.25mm){};
% px (x direction)
\fill[red!40](103mm,81.5mm) rectangle (130mm,83mm);
% px (y direction)
\fill[blue!40](103mm,80mm) rectangle (130mm,81.5mm);
% py (y direction)
\fill[blue!40](103mm,76.25mm) rectangle (130mm,78.5mm);
% px (z direction)
\fill[green!40](103mm,78.5mm) rectangle (130mm,80mm);
\draw[very thin, dashed](103mm,78.5mm)--(130mm,78.5mm);
% py (z direction)
\fill[green!40](103mm,74mm) rectangle (130mm,76.25mm);
\draw[very thin, dashed](103mm,74mm)--(130mm,74mm);
% pz (z direction)
\fill[green!40](103mm,69.5mm) rectangle (130mm,74mm);
%
\draw[very thin, dashed](107.5mm,83mm)--(107.5mm,69.5mm);
\draw[very thin, dashed](112mm,83mm)--(112mm,69.5mm);
\draw[very thin, dashed](116.5mm,83mm)--(116.5mm,69.5mm);
\draw[very thin, dashed](121mm,83mm)--(121mm,69.5mm);
\draw[very thin, dashed](125.5mm,83mm)--(125.5mm,69.5mm);
%
\node at (105.5mm,85mm) {$\scriptstyle d_{xx}$};
\node at (110mm,85mm) {$\scriptstyle d_{xy}$};
\node at (114.5mm,85mm) {$\scriptstyle d_{yy}$};
\node at (119mm,85mm) {$\scriptstyle d_{xz}$};
\node at (123.5mm,85mm) {$\scriptstyle d_{yz}$};
\node at (128mm,85mm) {$\scriptstyle d_{zz}$};
\node at (101mm,81mm) {$p_{x}$};
\node at (101mm,76.5mm) {$p_{y}$};
\node at (101mm,72mm) {$p_{z}$};
%
\node[block, minimum width=45mm, minimum height=27mm](sub-df) at (152.5mm,96.5mm){};
% dxx (x direction)
\fill[red!40](130mm,108.5mm) rectangle (143.5mm,110mm);
\fill[red!40](148mm,108.5mm) rectangle (157mm,110mm);
\fill[red!40](161.5mm,108.5mm) rectangle (166mm,110mm);
% dxx (y direction)
\fill[blue!40](134.5mm,107mm) rectangle (148mm,108.5mm);
\fill[blue!40](152.5mm,107mm) rectangle (161.5mm,108.5mm);
\fill[blue!40](166mm,107mm) rectangle (170.5mm,108.5mm);
% dxy (y direction)
\fill[blue!40](134.5mm,103.25mm) rectangle (148mm,105.5mm);
\fill[blue!40](152.5mm,103.25mm) rectangle (161.5mm,105.5mm);
\fill[blue!40](166mm,103.25mm) rectangle (170.5mm,105.5mm);
% dyy (y direction)
\fill[blue!40](134.5mm,98.75mm) rectangle (148mm,101mm);
\fill[blue!40](152.5mm,98.75mm) rectangle (161.5mm,101mm);
\fill[blue!40](166mm,98.75mm) rectangle (170.5mm,101mm);
% dxx (z direction)
\fill[green!40](148mm,105.5mm) rectangle (175mm,107mm);
\draw[very thin, dashed](130mm,105.5mm)--(175mm,105.5mm);
% dxy (z direction)
\fill[green!40](148mm,101mm) rectangle (175mm,103.25mm);
\draw[very thin, dashed](130mm,101mm)--(175mm,101mm);
% dyy (z direction)
\fill[green!40](148mm,96.5mm) rectangle (175mm,98.75mm);
\draw[very thin, dashed](130mm,96.5mm)--(175mm,96.5mm);
% others (z direction)
\fill[green!40](148mm,83mm) rectangle (175mm,96.5mm);
\draw[very thin, dashed](130mm,92mm)--(175mm,92mm);
\draw[very thin, dashed](130mm,87.5mm)--(175mm,87.5mm);
%
\draw[very thin, dashed](134.5mm,110mm)--(134.5mm,83mm);
\draw[very thin, dashed](139mm,110mm)--(139mm,83mm);
\draw[very thin, dashed](143.5mm,110mm)--(143.5mm,83mm);
\draw[very thin, dashed](148mm,110mm)--(148mm,83mm);
\draw[very thin, dashed](152.5mm,110mm)--(152.5mm,83mm);
\draw[very thin, dashed](157mm,110mm)--(157mm,83mm);
\draw[very thin, dashed](161.5mm,110mm)--(161.5mm,83mm);
\draw[very thin, dashed](166mm,110mm)--(166mm,83mm);
\draw[very thin, dashed](170.5mm,110mm)--(170.5mm,83mm);
%
\node at (133mm,81mm) {$\scriptstyle f_{xxx}$};
\node at (137.5mm,112mm) {$\scriptstyle f_{xxy}$};
\node at (142mm,81mm) {$\scriptstyle f_{xyy}$};
\node at (146.5mm,112mm) {$\scriptstyle f_{yyy}$};
\node at (151mm,81mm) {$\scriptstyle f_{xxz}$};
\node at (155.5mm,112mm) {$\scriptstyle f_{xyz}$};
\node at (160mm,81mm) {$\scriptstyle f_{yyz}$};
\node at (164.5mm,112mm) {$\scriptstyle f_{xzz}$};
\node at (169mm,81mm) {$\scriptstyle f_{yzz}$};
\node at (173.5mm,112mm) {$\scriptstyle f_{zzz}$};
\node at (179mm,108mm) {$d_{xx}$};
\node at (179mm,103.5mm) {$d_{xy}$};
\node at (179mm,99mm) {$d_{yy}$};
\node at (179mm,94.5mm) {$d_{xz}$};
\node at (179mm,90mm) {$d_{yz}$};
\node at (179mm,85.5mm) {$d_{zz}$};
%
\node[block, minimum width=27mm, minimum height=45mm](sub-fd) at (116.5mm,132.5mm){};
% from x direction
\fill[red!40](103mm,150.5mm) rectangle (130mm,155mm);
\draw[very thin, dashed](103mm,150.5mm)--(130mm,150.5mm);
% from y direction
\fill[blue!40](103mm,137mm) rectangle (130mm,150.5mm);
\draw[very thin, dashed](103mm,146mm)--(130mm,146mm);
\draw[very thin, dashed](103mm,141.5mm)--(130mm,141.5mm);
% from z direction
\fill[green!40](103mm,110mm) rectangle (130mm,137mm);
\draw[very thin, dashed](103mm,137mm)--(130mm,137mm);
\draw[very thin, dashed](103mm,132.5mm)--(130mm,132.5mm);
\draw[very thin, dashed](103mm,128mm)--(130mm,128mm);
\draw[very thin, dashed](103mm,123.5mm)--(130mm,123.5mm);
\draw[very thin, dashed](103mm,119mm)--(130mm,119mm);
\draw[very thin, dashed](103mm,114.5mm)--(130mm,114.5mm);
\node at (105.5mm,108mm) {$\scriptstyle d_{xx}$};
\node at (110mm,108mm) {$\scriptstyle d_{xy}$};
\node at (114.5mm,108mm) {$\scriptstyle d_{yy}$};
\node at (119mm,108mm) {$\scriptstyle d_{xz}$};
\node at (123.5mm,108mm) {$\scriptstyle d_{yz}$};
\node at (128mm,108mm) {$\scriptstyle d_{zz}$};
\node at (99mm,152.5mm) {$f_{xxx}$};
\node at (99mm,148mm) {$f_{xxy}$};
\node at (99mm,143.5mm) {$f_{xyy}$};
\node at (99mm,139mm) {$f_{yyy}$};
\node at (99mm,134.5mm) {$f_{xxz}$};
\node at (99mm,130mm) {$f_{xyz}$};
\node at (99mm,125.5mm) {$f_{yyz}$};
\node at (99mm,121mm) {$f_{xzz}$};
\node at (99mm,116.5mm) {$f_{yzz}$};
\node at (99mm,112mm) {$f_{zzz}$};
%
\draw[very thin, dashed](107.5mm,155mm)--(107.5mm,110mm);
\draw[very thin, dashed](112mm,155mm)--(112mm,110mm);
\draw[very thin, dashed](116.5mm,155mm)--(116.5mm,110mm);
\draw[very thin, dashed](121mm,155mm)--(121mm,110mm);
\draw[very thin, dashed](125.5mm,155mm)--(125.5mm,110mm);

% first order
\node[block, text width=5mm, inner xsep=0.5mm, inner ysep=0.9mm, text centered, text height=0.5mm](px-x) at (140mm,162.5mm) {$p_{x}$};
\node[block, text width=5mm, inner xsep=0.5mm, inner ysep=1.1mm, text centered, text height=0.5mm](px-y) at (140mm,153.3mm) {$p_{x}$};
\node[block, text width=5mm, inner xsep=0.5mm, inner ysep=1mm, text centered, text height=0.5mm](py-y) at (140mm,148.4mm) {$p_{y}$};
\node[block, text width=5mm, inner xsep=0.5mm, inner ysep=0.9mm, text centered, text height=0.5mm](px-z) at (140mm,129.3mm) {$p_{x}$};
\node[block, text width=5mm, inner xsep=0.5mm, inner ysep=0.9mm, text centered, text height=0.5mm](py-z) at (140mm,124.6mm) {$p_{y}$};
\node[block, text width=5mm, inner xsep=0.5mm, inner ysep=0.9mm, text centered, text height=0.5mm](pz-z) at (140mm,119.9mm) {$p_{z}$};
% second order
\node[block, color=red, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dxx-x) at (146mm,162.5mm) {$d_{xx}$};
\node[block, color=blue, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dxx-y) at (146mm,158mm) {$d_{xx}$};
\node[block, color=blue, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dxy-y) at (146mm,153.3mm) {$d_{xy}$};
\node[block, color=blue, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dyy-y) at (146mm,148.4mm) {$d_{yy}$};
\node[block, color=green, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dxx-z) at (146mm,143.7mm) {$d_{xx}$};
\node[block, color=green, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dxy-z) at (146mm,139mm) {$d_{xy}$};
\node[block, color=green, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dyy-z) at (146mm,134mm) {$d_{yy}$};
\node[block, color=green, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dxz) at (146mm,129.3mm) {$d_{xz}$};
\node[block, color=green, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dyz) at (146mm,124.6mm) {$d_{yz}$};
\node[block, color=green, text width=5mm, inner sep=0.5mm, text centered, text height=0.5mm](dzz) at (146mm,119.9mm) {$d_{zz}$};
% third order
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=30mm, right of=dxx-z](fxxz){$f_{xxz}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=4.7mm, above of=fxxz](fyyy){$f_{yyy}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=5mm, above of=fyyy](fxyy){$f_{xyy}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=5mm, above of=fxyy](fxxy){$f_{xxy}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=4.7mm, above of=fxxy](fxxx){$f_{xxx}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=4.7mm, below of=fxxz](fxyz){$f_{xyz}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=5mm, below of=fxyz](fyyz){$f_{yyz}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=4.7mm, below of=fyyz](fxzz){$f_{xzz}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=4.7mm, below of=fxzz](fyzz){$f_{yzz}$};
\node[block, text width=7mm, inner sep=0.5mm, text centered, text height=0.5mm, node distance=4.7mm, below of=fyzz](fzzz){$f_{zzz}$};
%
\path[arrow, color=red, dotted](dxx-x)--node{\color{red}$x_\text{recurrence}$}(fxxx);
\path[arrow, color=blue, dashed](dxx-y)--node{\color{blue}$y_\text{recurrence}$}(fxxy);
\path[arrow, color=blue, dashed](dxy-y)--node{\color{blue}$y_\text{recurrence}$}(fxyy);
\path[arrow, color=blue, dashed](dyy-y)--node{\color{blue}$y_\text{recurrence}$}(fyyy);
\path[arrow, color=green](dxx-z)--node{\color{green}$z_\text{recurrence}$}(fxxz);
\path[arrow, color=green](dxy-z)--node{\color{green}$z_\text{recurrence}$}(fxyz);
\path[arrow, color=green](dyy-z)--node{\color{green}$z_\text{recurrence}$}(fyyz);
\path[arrow, color=green](dxz)--node{\color{green}$z_\text{recurrence}$}(fxzz);
\path[arrow, color=green](dyz)--node{\color{green}$z_\text{recurrence}$}(fyzz);
\path[arrow, color=green](dzz)--node{\color{green}$z_\text{recurrence}$}(fzzz);

%\node at (120mm,115mm) %
%  {memory$\approx(|\boldsymbol{j}|+1)[(|\boldsymbol{i}|+1)(|\boldsymbol{i}|+2)(3|\boldsymbol{j}|+2)+2|\boldsymbol{j}|]$};

\node at (139mm,60mm) (algorithm-j-major) {\small\textbf{Algorithm ($\boldsymbol{j}$ major)}};
\node[block, color=black, fill=black!5, text width=20em, text badly ragged, below of=algorithm-j-major, yshift=-32mm]%
  {\footnotesize
   do $n_\text{recur}$ = $0$, $\max_\text{Cart}-1$\\
     \hspace{1em}do $|\boldsymbol{j}|$ = $\min_\text{Herm}$, $\max_\text{Cart}+\max_\text{Herm}-n_\text{recur}-1$\\
       \hspace{2em}do $n_{\boldsymbol{j}}$ = $|\boldsymbol{j}|$, $0$, $-1$\\
         \hspace{3em}do $n'_{\boldsymbol{j}}$ = $0$, $n_{\boldsymbol{j}}$\\
           \color{red}
           \hspace{4em}$x_\text{recurrence}$ with $\boldsymbol{i}_{x}=n_\text{recur}$\\
           \color{blue}
           \hspace{4em}do $n_{\boldsymbol{i}}$ = 0, $n_\text{recur}$\\
             \hspace{5em}$y_\text{recurrence}$ with $\boldsymbol{i}_{y}=n_{\boldsymbol{i}}$\\
           \hspace{4em}end do\\
           \color{green}
           \hspace{4em}do $n_{\boldsymbol{i}}$ = 0, $n_\text{recur}$\\
             \hspace{5em}do $n'_{\boldsymbol{i}}$ = $0$, $n_\text{recur}-n_{\boldsymbol{i}}$\\
               \hspace{6em}$z_\text{recurrence}$ with $\boldsymbol{i}_{z}=n_{\boldsymbol{i}}$\\
             \hspace{5em}end do\\
           \hspace{4em}end do\\
         \color{black}
         \hspace{3em}end do\\
       \hspace{2em}end do\\
     \hspace{1em}end do\\
   end do};
% i-major
%  {do n$_\text{Cart}$ = 1, $\max_\text{Cart}$\\
%     \color{red}
%     \hspace{1em}do n$_\text{Herm}$ = $\min_\text{Herm}$, $\max_\text{Cart}+\max_\text{Herm}-\text{n}_\text{Cart}$\\
%       \hspace{2em}$x_\text{recurrence}$ with $\boldsymbol{i}_{x}=\text{n}_\text{Cart}-1$, and $|\boldsymbol{j}|=\text{n}_\text{Herm}$\\
%     \hspace{1em}end do\\
%     \color{blue}
%     \hspace{1em}do n$_\text{recur}$ = 0, n$_\text{Cart}-$1\\
%       \hspace{2em}do n$_\text{Herm}$ = $\min_\text{Herm}$, $\max_\text{Cart}+\max_\text{Herm}-\text{n}_\text{Cart}$\\
%         \hspace{3em}$y_\text{recurrence}$ with $\boldsymbol{i}_{y}=\text{n}_\text{recur}$, and $|\boldsymbol{j}|=\text{n}_\text{Herm}$\\
%       \hspace{2em}end do\\
%     \hspace{1em}end do\\
%     \color{green}
%     \hspace{1em}do n$_\text{recur}$ = 0, $\text{n}_\text{Cart}-$1\\
%       \hspace{2em}do n$'_\text{recur}$ = 1, $\text{n}_\text{Cart}-\text{n}_\text{recur}$\\
%         \hspace{3em}do n$_\text{Herm}$ = $\min_\text{Herm}$, $\max_\text{Cart}+\max_\text{Herm}-\text{n}_\text{Cart}$\\
%           \hspace{4em}$z_\text{recurrence}$ with $\boldsymbol{i}_{z}=\text{n}_\text{recur}$, and $|\boldsymbol{j}|=\text{n}_\text{Herm}$\\
%         \hspace{3em}end do\\
%       \hspace{2em}end do\\
%     \hspace{1em}end do\\
%   \color{black}
%   end do};

\end{tikzpicture}

\end{document}
